
(STRATEGY
    INNERMOST)

(VAR
    x27 x10 x6 x18 x34 x9 x7 x5 x3 x4 x22 x2 x1 x26 x17 x20 x12 x44 x14 x36 x25)
(RULES
    main(S(S(x27))) -> evalState_cond(bind[3](memoM[2](S(x27))
                                             ,liftM2_f_m1_m2(memoM[2](x27))
                                             ,Nil()))
    main(S(0())) -> evalState_cond(return[2](S(0()),Nil()))
    main(0()) -> evalState_cond(return[2](S(0()),Nil()))
    rec[plus_0][2](S(x10),x6) -> S(rec[plus_0][2](x10,x6))
    rec[plus_0][2](0(),x18) -> x18
    rec[equal_0][2](S(x10),S(x6)) -> rec[equal_0][2](x10,x6)
    rec[equal_0][2](S(x34),0()) -> False()
    rec[equal_0][2](0(),S(x34)) -> False()
    rec[equal_0][2](0(),0()) -> True()
    find_key[1](x9,Cons(Pair(x7,x5),x3)) -> find_cond_2(rec[equal_0][2](x7,x9)
                                                       ,x9
                                                       ,x3
                                                       ,x5)
    find_key[1](x3,Nil()) -> None()
    find_cond_2(False(),x6,x4,x7) -> find_key[1](x6,x4)
    find_cond_2(True(),x7,x5,x3) -> Some(x3)
    return[2](x18,x22) -> Pair(x22,x18)
    bind[3](x3,x2,x1) -> bind_m_f[1](x3,x2,x1)
    bind[2](x22,x26) -> bind_m_f(x22,x26)
    bind_m_f[1](get(),x2,x1) -> bind_cond(Pair(x1,x1),x2)
    bind_m_f[1](bind_m_f(x4,x3),x2,x1) -> bind_cond(bind_m_f[1](x4,x3,x1),x2)
    bind_m_f[1](return_a(S(0())),x2,x1) -> bind_cond(Pair(x1,S(0())),x2)
    bind_m_f[1](modify_f(insertM_a(x4,x3)),x2,x1) ->
      bind_cond(Pair(Cons(Pair(x4,x3),x1),Unit()),x2)
    bind_cond(Pair(x3,x2),liftM_f_m(find_key(x1))) -> return[2](find_key[1](x1
                                                                           ,x2)
                                                               ,x3)
    bind_cond(Pair(x4,Some(x3)),memoM_m_v_2(x2,insertM(x1))) -> return[2](x3,x4)
    bind_cond(Pair(x3,None()),memoM_m_v_2(S(S(x2)),insertM(x1))) ->
      bind[3](bind[2](memoM[2](S(x2)),liftM2_f_m1_m2(memoM[2](x2)))
             ,memoM_0(insertM(x1))
             ,x3)
    bind_cond(Pair(x2,None()),memoM_m_v_2(S(0()),insertM(x1))) ->
      bind[3](return_a(S(0())),memoM_0(insertM(x1)),x2)
    bind_cond(Pair(x2,None()),memoM_m_v_2(0(),insertM(x1))) ->
      bind[3](return_a(S(0())),memoM_0(insertM(x1)),x2)
    bind_cond(Pair(x4,x6),liftM2_f_m1_m2(x10)) -> bind[3](x10
                                                         ,liftM2_f_m1_m2_1(x6)
                                                         ,x4)
    bind_cond(Pair(x3,x2),liftM2_f_m1_m2_1(x1)) -> return[2](rec[plus_0][2](x1
                                                                           ,x2)
                                                            ,x3)
    bind_cond(Pair(x17,x20),memoM_0(insertM(x12))) ->
      bind[3](modify_f(insertM_a(x12,x20)),bind'_m1_m2(return_a(x20)),x17)
    bind_cond(Pair(x44,x14),bind'_m1_m2(return_a(x36))) -> Pair(x44,x36)
    evalState_cond(Pair(x25,x27)) -> x27
    memoM[2](x1) -> bind[2](bind[2](get(),liftM_f_m(find_key(x1)))
                           ,memoM_m_v_2(x1,insertM(x1))))

