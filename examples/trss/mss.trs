
(STRATEGY
    INNERMOST)

(VAR
    x1 x3 x2)
(RULES
    rec[foldl_0][3](rec[max_0](),x1,Nil()) -> x1
    rec[foldl_0][3](rec[max_0](),x3,Cons(x2,x1)) ->
      rec[foldl_0][3](rec[max_0](),rec[max_0][2](x3,x2),x1)
    rec[max_0][2](0(),x1) -> x1
    rec[max_0][2](S(x1),0()) -> S(x1)
    rec[max_0][2](S(x2),S(x1)) -> S(rec[max_0][2](x2,x1))
    scanr_cond_1(Cons(0(),x1),rec[f_0](),0()) -> Cons(0(),Cons(0(),x1))
    scanr_cond_1(Cons(S(x2),x1),rec[f_0](),0()) -> Cons(S(x2),Cons(S(x2),x1))
    scanr_cond_1(Cons(0(),x2),rec[f_0](),M(x1)) -> Cons(0(),Cons(0(),x2))
    scanr_cond_1(Cons(S(x3),x2),rec[f_0](),M(x1)) -> Cons(rec[minus_0][2](S(x3)
                                                                         ,x1)
                                                         ,Cons(S(x3),x2))
    scanr_cond_1(Cons(0(),x2),rec[f_0](),S(x1)) -> Cons(S(x1),Cons(0(),x2))
    scanr_cond_1(Cons(S(x3),x2),rec[f_0](),S(x1)) -> Cons(rec[plus_0][2](S(x1)
                                                                        ,S(x3))
                                                         ,Cons(S(x3),x2))
    rec[scanr_0][3](rec[f_0](),0(),Nil()) -> Cons(0(),Nil())
    rec[scanr_0][3](rec[f_0](),0(),Cons(x2,x1)) ->
      scanr_cond_1(rec[scanr_0][3](rec[f_0](),0(),x1),rec[f_0](),x2)
    rec[minus_0][2](0(),x1) -> 0()
    rec[minus_0][2](S(x1),0()) -> S(x1)
    rec[minus_0][2](S(x2),S(x1)) -> rec[minus_0][2](x2,x1)
    rec[plus_0][2](0(),S(x1)) -> S(x1)
    rec[plus_0][2](S(x2),S(x1)) -> S(rec[plus_0][2](x2,S(x1)))
    main(x1) -> rec[foldl_0][3](rec[max_0]()
                               ,0()
                               ,rec[scanr_0][3](rec[f_0](),0(),x1)))

