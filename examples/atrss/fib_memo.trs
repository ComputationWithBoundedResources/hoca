
(STRATEGY
    INNERMOST)

(VAR
    x4 x5 x2 x3 x8 x9 x7 x6 x0 x10 x12 x15 x14 x16 x13 x11 x1)
(RULES
    evalState_cond(Pair(x4,x5)) -> x5
    @(evalState_m(x2),x3) -> evalState_cond(@(x2,x3))
    @(evalState(),x2) -> evalState_m(x2)
    fibM_cond(0()) -> @(return(),S(0()))
    fibM_cond_1(0(),x3) -> @(return(),S(0()))
    @(liftM2_1(x5,x8),x9) -> @(return(),@(@(x5,x8),x9))
    @(liftM2_0(x5,x7),x8) -> @(@(bind(),x7),liftM2_1(x5,x8))
    @(liftM2_f_m1(x5,x6),x7) -> @(@(bind(),x6),liftM2_0(x5,x7))
    @(liftM2_f(x5),x6) -> liftM2_f_m1(x5,x6)
    @(liftM2(),x5) -> liftM2_f(x5)
    plus_cond(0(),x6) -> x6
    plus_cond(S(x7),x6) -> S(@(@(rec[plus_0](),x7),x6))
    @(plus_x(x5),x6) -> plus_cond(x5,x6)
    @(plus(),x5) -> plus_x(x5)
    @(rec[plus_0](),x0) -> @(plus(),x0)
    find_cond(Nil(),x7) -> None()
    find_cond_2(True(),x7,x10,x12) -> Some(x12)
    find_cond_2(False(),x7,x10,x12) -> @(@(rec[find_0](),x7),x10)
    equal_cond_1(0()) -> True()
    equal_cond_1(S(x15)) -> False()
    equal_cond(0(),x14) -> equal_cond_1(x14)
    equal_cond_2(0(),x15) -> False()
    equal_cond_2(S(x16),x15) -> @(@(rec[equal_0](),x15),x16)
    equal_cond(S(x15),x14) -> equal_cond_2(x14,x15)
    @(equal_x(x13),x14) -> equal_cond(x13,x14)
    @(equal(),x13) -> equal_x(x13)
    @(rec[equal_0](),x0) -> @(equal(),x0)
    find_cond_1(Pair(x11,x12),x7,x10) -> find_cond_2(@(@(rec[equal_0](),x11),x7)
                                                    ,x7
                                                    ,x10
                                                    ,x12)
    find_cond(Cons(x9,x10),x7) -> find_cond_1(x9,x7,x10)
    @(find_key(x7),x8) -> find_cond(x8,x7)
    @(find(),x7) -> find_key(x7)
    @(rec[find_0](),x0) -> @(find(),x0)
    @(liftM_0(x7),x9) -> @(return(),@(x7,x9))
    @(liftM_f(x7),x8) -> @(@(bind(),x8),liftM_0(x7))
    @(liftM(),x7) -> liftM_f(x7)
    @(get(),x7) -> Pair(x7,x7)
    bind_cond(Pair(x14,x15),x12) -> @(@(x12,x15),x14)
    @(bind_m_f(x11,x12),x13) -> bind_cond(@(x11,x13),x12)
    @(bind_m(x11),x12) -> bind_m_f(x11,x12)
    @(bind(),x11) -> bind_m(x11)
    @(bind'_0(x10),x11) -> x10
    @(bind'_m1(x9),x10) -> @(@(bind(),x9),bind'_0(x10))
    @(bind'(),x9) -> bind'_m1(x9)
    @(modify_f(x10),x11) -> Pair(@(x10,x11),Unit())
    @(modify(),x10) -> modify_f(x10)
    @(insertM_0(x6,x9),x10) -> Cons(Pair(x6,x9),x10)
    @(insertM(x6),x9) -> @(modify(),insertM_0(x6,x9))
    @(memoM_1(x6),x8) -> @(@(bind'(),@(insertM(x6),x8)),@(return(),x8))
    memoM_cond(None(),x5,x6) -> @(@(bind(),@(x5,x6)),memoM_1(x6))
    @(return_a(x9),x10) -> Pair(x10,x9)
    @(return(),x9) -> return_a(x9)
    memoM_cond(Some(x8),x5,x6) -> @(return(),x8)
    @(memoM_0(x5,x6),x7) -> memoM_cond(x7,x5,x6)
    @(memoM_m(x5),x6) -> @(@(bind(),@(@(liftM(),@(rec[find_0](),x6)),get()))
                          ,memoM_0(x5,x6))
    @(memoM(),x5) -> memoM_m(x5)
    fibM_cond_1(S(x4),x3) -> @(@(@(liftM2(),rec[plus_0]())
                                ,@(@(memoM(),rec[fibM_0]()),x3))
                              ,@(@(memoM(),rec[fibM_0]()),x4))
    fibM_cond(S(x3)) -> fibM_cond_1(x3,x3)
    @(fibM(),x2) -> fibM_cond(x2)
    @(rec[fibM_0](),x0) -> @(fibM(),x0)
    @(fib(),x1) -> @(@(evalState(),@(rec[fibM_0](),x1)),Nil())
    main(x0) -> @(fib(),x0))

